@startuml
hide empty members

' Remove the following lines when VLBI, PSS and PST
' are added to CDM
remove VLBIConfiguration
remove PSTConfiguration
remove PSSConfiguration

package ska_tmc_cdm.messages.subarray_node.configure {
	package csp.py <<Rectangle>> {

	    class SubarrayConfiguration {
	        subarray_name: str
	    }

	    class CommonConfiguration {
	        config_id: str
            frequency_band: core.ReceiverBand
            subarray_id: int
            band_5_tuning: List[float]
	    }

	    class CBFConfiguration {
            vlbi: dict
	    }

	    class PSTConfiguration {

	    }

        class PSSConfiguration {

        }

        class VLBIConfiguration {

        }

		enum FSPFunctionMode {
			CORR
			PSS-BF
			PST-BF
			VLBI
		}

		class FSPConfiguration {
			fsp_id : int
			function_mode : FSPFunctionMode
			frequency_slice_id : int
			integration_factor : int
			zoom_factor : int
			channel_average_map : List[Tuple]
			output_link_map : List[Tuple]
			zoom_window_tuning: int
		}

		class CSPConfiguration {
	        interface: str
	        pss: dict
	        pst: dict

		}

		class LowCBFConfiguration {
			stations: StationConfiguration 
			timing_beams: TimingBeamConfiguration
		}

		class StationConfiguration {
			stns: List[List[int]]
        	stn_beams: List[StnBeamConfiguration]
		}

		class TimingBeamConfiguration {
			beams: List[BeamConfiguration]
		}
		
		class BeamConfiguration {
			pst_beam_id: int
			stn_beam_id: int
			offset_dly_poly: str
			stn_weights: List[float]
			jones: str
			dest_chans: List[int]
			rfi_enable: List[bool]
			rfi_static_chans: List[int]
			rfi_dynamic_chans: List[int]
			rfi_weighted: float
		}

		class StnBeamConfiguration {
			beam_id: int
			freq_ids: List[int]
			boresight_dly_poly: str
		}

		CBFConfiguration *-- "*" FSPConfiguration
		CBFConfiguration *-- "1" VLBIConfiguration
		CSPConfiguration *-- "1" CommonConfiguration
		CSPConfiguration *-- "1" SubarrayConfiguration
		CSPConfiguration *-- "0..1" CBFConfiguration
		CSPConfiguration *-- "1" PSTConfiguration
		CSPConfiguration *-- "1" PSSConfiguration
		CSPConfiguration *-- "1" LowCBFConfiguration
		LowCBFConfiguration *-- "1" StationConfiguration
		LowCBFConfiguration *-- "1" TimingBeamConfiguration
		TimingBeamConfiguration *-- "*" BeamConfiguration
		StationConfiguration *-- "*" StnBeamConfiguration
	}
}
@enduml